# 代码规范标准 (React + TypeScript + Tailwind)

## 1. 文件行数规范

### 1.1 纯逻辑层 (`utils/`, `lib/`, `services/`, `hooks/`)

| 级别   | 行数     |
| ------ | -------- |
| 建议   | ≤ 150 行 |
| 警戒   | > 200 行 |
| 硬上限 | 300 行   |

### 1.2 单个函数/方法

| 级别   | 行数       |
| ------ | ---------- |
| 建议   | ≤ 40-60 行 |
| 警戒   | > 80 行    |
| 硬上限 | 120 行     |

### 1.3 UI 组件层 (`components/`)

| 级别   | 行数         |
| ------ | ------------ |
| 建议   | ≤ 250-300 行 |
| 警戒   | > 400 行     |
| 硬上限 | 600 行       |

### 1.4 页面层 (`pages/`, `views/`)

| 级别   | 行数                  |
| ------ | --------------------- |
| 建议   | ≤ 400-600 行          |
| 警戒   | > 800 行              |
| 硬上限 | 1200 行（需说明原因） |

## 2. Tailwind 专属规范

### 2.1 className 长度控制

- 单个元素 `className` 超过 **160-200 字符** 或 **2 行以上**：
  - 抽成 `cn()` 组合函数
  - 或抽成子组件

### 2.2 JSX 嵌套层级

- 嵌套层级 **> 6 层** 需考虑拆分结构

## 3. 组件质量指标

### 3.1 State 数量

- `useState/useReducer` 合计 **> 8** 为高风险，需拆分

### 3.2 useEffect 数量

- **> 4** 个需抽 hooks 或重新划分数据流

### 3.3 Props 数量

- 单组件 props **> 12** 提示组件边界不清

### 3.4 圈复杂度

- 核心函数建议 **≤ 10-15**

## 4. 文件职责原则

### 4.1 单一职责

- 一个文件最多做 **1 个主职责 + 1 个辅助职责**

### 4.2 页面文件职责

页面文件只做：

- Layout 布局
- 组装子组件
- 连接 Store
- 业务规则全部在 `hooks/` 或 `domain/` 里

## 5. 目录结构规范

```
src/
├── api/              # API 调用层 (≤150行/文件)
├── components/       # 通用组件
│   ├── ui/          # 基础 UI 组件 (≤300行)
│   └── layout/      # 布局组件 (≤300行)
├── hooks/           # 自定义 Hooks (≤150行)
├── pages/           # 页面组件
│   └── [page]/      # 每个页面一个目录
│       ├── index.tsx           # 页面入口 (≤600行)
│       ├── components/         # 页面专属组件
│       ├── hooks/              # 页面专属 hooks
│       └── types.ts            # 页面类型定义
├── stores/          # 状态管理 (≤200行)
├── types/           # 全局类型定义 (≤150行)
├── utils/           # 工具函数 (≤150行)
└── locales/         # 国际化
```

## 6. 命名规范

### 6.1 文件命名

- 组件文件：PascalCase (`Button.tsx`)
- 工具/hooks：camelCase (`useAuth.ts`, `formatDate.ts`)
- 类型文件：camelCase (`user.ts`)
- 常量文件：camelCase (`constants.ts`)

### 6.2 组件命名

- 组件名与文件名一致
- 页面组件以 `Page` 结尾可选

### 6.3 Hook 命名

- 以 `use` 开头 (`useSubmission`, `useCanvasZoom`)

## 7. 拆分策略

### 7.1 何时拆分组件

- JSX 超过 100 行
- 有独立的交互逻辑
- 可复用于其他地方
- 嵌套层级过深

### 7.2 何时抽取 Hook

- 多个 `useEffect` 处理相关逻辑
- State + 操作函数形成内聚单元
- 逻辑可复用

### 7.3 何时抽取 Service

- API 调用逻辑
- 复杂数据转换
- 业务规则计算
